<!doctype html>
<meta charset="utf-8" />
<title>World dots texture â€” black dots on white</title>
<canvas id="map" width="4096" height="2048"></canvas>
<script type="module">
  import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";
  import { feature } from "https://cdn.jsdelivr.net/npm/topojson-client@3/+esm";

  // ===== Settings =====
  const W = 8192,
    H = 4096; // Use 8192x4096 for 8K
  const BACKGROUND = "#ffffff"; // white background
  const DOT_COLOR = "#000000"; // black dots
  const DOT_SPACING = 16; // px between dots (density)
  const DOT_RADIUS = 6; // dot size in px
  const USE_HEX = true; // hexagonal staggering for nicer look

  const canvas = document.getElementById("map");
  canvas.width = W;
  canvas.height = H;
  const ctx = canvas.getContext("2d");

  // Paint background white
  ctx.fillStyle = BACKGROUND;
  ctx.fillRect(0, 0, W, H);

  // Equirectangular projection for sphere UVs
  const projection = d3.geoEquirectangular().fitExtent(
    [
      [0, 0],
      [W, H],
    ],
    { type: "Sphere" }
  );
  const path = d3.geoPath(projection, ctx);

  // Countries
  const world = await fetch(
    "https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json"
  ).then((r) => r.json());
  const countries = feature(world, world.objects.countries);

  // Clip to land
  ctx.save();
  ctx.beginPath();
  path(countries);
  ctx.clip();

  // Draw dot grid (clipped to land)
  ctx.fillStyle = DOT_COLOR;
  const stepX = DOT_SPACING;
  const stepY = USE_HEX ? (DOT_SPACING * Math.sqrt(3)) / 2 : DOT_SPACING;

  for (let row = 0, y = stepY / 2; y < H; row++, y += stepY) {
    const offset = USE_HEX ? (row % 2 ? stepX / 2 : 0) : 0;
    for (let x = offset + stepX / 2; x < W; x += stepX) {
      ctx.beginPath();
      ctx.arc(x, y, DOT_RADIUS, 0, Math.PI * 2);
      ctx.fill();
    }
  }

  ctx.restore();

  // Download link
  const a = document.createElement("a");
  a.download = `world-dots-black-${W}x${H}.png`;
  a.href = canvas.toDataURL("image/png");
  a.textContent = "Download PNG";
  a.style.cssText = "display:inline-block;margin:12px;font:14px system-ui";
  document.body.appendChild(a);
</script>
